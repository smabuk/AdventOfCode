using System.Collections.Generic;
using System.Linq;

namespace AdventOfCode.Shared {
	/// <summary>
	/// Day 3: Toboggan Trajectory
	/// https://adventofcode.com/2020/day/3
	/// </summary>
	public static class Solution_2020_03 {
		static readonly string[] _tobogganInput =
		{
			".....##.#.....#........#....##.",
			"....#...#...#.#.......#........",
			".....##.#......#.......#.......",
			"...##.........#...#............",
			"........#...#.......#.........#",
			"..........#......#..#....#....#",
			"..................#..#..#....##",
			".....##...#..#..#..#..#.##.....",
			"..##.###....#.#.........#......",
			"#.......#......#......#....##..",
			".....#..#.#.......#......#.....",
			"............#............#.....",
			"...#.#........#........#.#.##.#",
			".#..#...#.....#....##..........",
			"##..........#...#...#..........",
			"...........#...###...#.......##",
			".#..#............#........#....",
			"##.#..#.....#.......#.#.#......",
			".##.....#....#.#.......#.##....",
			"..##...........#.......#..##.#.",
			"##...#.#........#..#...#...#..#",
			".#..#........#.#.......#..#...#",
			".##.##.##...#.#............##..",
			"..#.#..###......#..#......#....",
			".#..#..#.##.#.##.#.#...........",
			"...#....#..#.#.#.........#..#..",
			"......#.#....##.##......#......",
			"#....#.##.##....#..#...........",
			"...#.#.#.#..#.#..#.#..#.##.....",
			"#.....#######.###.##.#.#.#.....",
			"..#.##.....##......#...#.......",
			"..#....#..#...##.#..#..#..#..#.",
			".............#.##....#.........",
			".#....#.##.....#...............",
			".#............#....#...#.##....",
			".#.....#.##.###.......#..#.....",
			".#...#.........#.......#..#....",
			"..#.#..#.##.......##...........",
			".....##..#..#..#..#.##..#.....#",
			"..##............##...#..#......",
			"...#..#....#..##.....##..#.#...",
			"#.....##....#.#.#...#...#..##.#",
			"#.#..#.........#.##.#...#.#.#..",
			".....#.#....##....#............",
			"#.......#..#.....##..#...#...#.",
			".....#.#...#...#..#......#.....",
			"..##....#.#.#.#.#..#...........",
			"##..#...#.........#......#...#.",
			"..#...#.#.#.#..#.#.##..##......",
			"#............###.....###.......",
			"..........#...#........###.....",
			".......##...#...#...#........#.",
			".#..#.##.#.....................",
			".#..##........##.##...#.......#",
			".......##......#.....#......#..",
			".##.#.....#......#......#......",
			"#...##.#.#...#.#...............",
			"........#..#...#.##.......#....",
			"...................#...#...##..",
			"...#...#.........#.....#..#.#..",
			".###..#........#..##.##..#.##..",
			"#...#.....#.....#.....#..#..#..",
			"###..#.....#.#.#.#......#....#.",
			"#........#....##.#...##........",
			".#.#..##........##....##.#.#...",
			"#...#....#.###.#.#.........#...",
			"...#...##..###.......#.........",
			"......#....#..##..#.....#.#....",
			"........#...##...###......##...",
			"..........##.#.......##........",
			"...#....#......#...##.....#....",
			"###.#.....#.#..#..#....#...#..#",
			".#.....#.#....#...............#",
			"..#....#....####....###....#.#.",
			"....##........#..#.##.#....#...",
			".......##...#...#..#....####...",
			"#...##.#......##...#..#........",
			"..##..#.##....#.......##.#.#...",
			"..#.#...............#...#.#....",
			"....#.....#.#.....#.##.......#.",
			"...#.#..##.#.#..............##.",
			"..#.....#...#.............#.##.",
			"##..#.#...#........#..#.....##.",
			"...........##...#.#.###...#....",
			"...#.#.#..#..................#.",
			".#...##.............#...#......",
			"..#..#...#.#.......#...#.....#.",
			"..##.......#.#.................",
			".##..#........###.....#....#.##",
			"......#..###.......#....##....#",
			"....#.....#.................#..",
			"........#...#...#..............",
			"...#..#.###.......#..#.#.#.##..",
			"..#...#.....#....#.........#...",
			"...#.............#........###..",
			"......#..............#......#..",
			"#..#...........#...#..........#",
			"...##...#.###..#...#.....#.#...",
			"....#..##......#.......##......",
			"....#....##.#...#.#..#....#...#",
			".#...........#..#....##...#..##",
			"..#.#.................###.#...#",
			"..#.#.#...##...........#.......",
			"..........#..##...#.#..##....##",
			"........#........#.##..#.#...#.",
			".....#...##.......##......#...#",
			"....#...#..#..#.....#..........",
			".#..#......#..#..#..###.......#",
			".##..........#...#...#.#.....##",
			"..#..........#.#.#...###.......",
			"....#................#...##....",
			".##..#....#..........#.#.#.....",
			"..##...#.#........#.....#.##...",
			"....####.....#..#.........##..#",
			"......#.........#...#..........",
			"....#...................#..##..",
			".##....#.#.........#....#...#..",
			"....##...##.....#..####........",
			"..##.#....#.#.......##...#.....",
			"#...#.#.#...#..#..##.....#.....",
			"#..................###.....#...",
			"#.#.....#.......#.#...###.#....",
			".#..#....#............#........",
			"#.#....#..#.#...............#..",
			"..#..#..#.............#......#.",
			"..#.......##...................",
			".#....#.........#....#.#.#..#..",
			"....#....#..#...............#..",
			"......#..#..##......#.........#",
			"..#.##........##......#..#..#.#",
			"#.....#.#....#.........##...#..",
			"###..............#....###...##.",
			"....#..##......#.......##......",
			"......#...#.##......##....#..#.",
			"..........#....#..##.......#..#",
			".#..#...##..#...........#..#..#",
			".....#....#...#..###...###....#",
			".#####..#...#.#.#..#.#.###...##",
			"..##............##.#...#.##...#",
			".##..#...#...#....##.#..#..##..",
			".#....#...#............##..#...",
			".#.#......#....#....#..##..##..",
			".........#...#.......#.##..#...",
			"#.........#.....##.....#..#..#.",
			"...##.#...#...#..#..#....##..##",
			".#............#...#....##......",
			"..#...#.##.........#.#......#.#",
			"....#.##........#.........#..##",
			"#.........#......#.#......#..#.",
			"........#.#.......#.#........#.",
			"..#..........##.#...#..#.#.....",
			"..#...#....#...#...#..#.#..#.#.",
			".#.........#....#..#####..#....",
			"#.#....#.#.###...#.............",
			"..##...........##......##......",
			"#.....#..#....#...............#",
			"...#.#..#....##......#...##....",
			"...#........#.....#...#..#.....",
			".#......##.........#......#....",
			"..#..###.##...#.#.....#........",
			".............#......#..#.......",
			"..#...............#.#...#..#..#",
			".......#..#...#.#####......#..#",
			".........#.....#...............",
			"##........#............#.#.....",
			".#...#.....#..#..#...#....#...#",
			"..#....#....##......##.....#.#.",
			"#...##..##......#...#....#.....",
			"....#.#.#.....###....##.##....#",
			"..........##...##.......#......",
			"..#.......#...##.#....##.##....",
			"....#........................#.",
			"...#...#.#.##...#.....#...#..#.",
			".#....##..#..#..........##..##.",
			".#.....#..#...#.##.....#.......",
			".#.##...#.#..#.....##....#...#.",
			".##...#........##....#..#......",
			".....#........#..........#.#..#",
			"....#..##.......#..#.....#.....",
			"...........#...#........#.##..#",
			".....#..#....#..#.#.....#....##",
			".....#....#.##.#..##...........",
			"...##.......##.........#.......",
			"...............##..#....#.#....",
			".......###..#........#..####.##",
			".......#.##...#.#....#.####....",
			"....#...............#..........",
			"##.#.......#.....#......#...#..",
			"......##.....#....#.....#..#..#",
			".....#...##.............#......",
			"#.#.##.#.....#..#........#.....",
			"......##....#..#........#......",
			"............#........#..#.#....",
			"##.......#......#...####..#.##.",
			"..##..#...#.............#.##...",
			".....#..##......#.##......###..",
			"............#........#........#",
			"#.#.#.#...#.#.....#.........#..",
			".........#...............#.....",
			".............###.#.......#....#",
			"###.##..#..#..........#....#...",
			"#......#...#..#..#.....#.##....",
			"............#....#....#..#.....",
			"..#.#....#...#......#.#..#..##.",
			"...#........................#..",
			"#.#...#..........#......#.#....",
			".........#................#...#",
			"##.....#....#........##.......#",
			"#...##........#...#...........#",
			"...#...#..........##.......#.#.",
			"..#.#.#....#......##...........",
			"...#.#...#.##.#..#.#.##........",
			"#....##.....###..#.......#.....",
			"###.....#.#.#...#..#.........##",
			"..#......#..###...#.#.#.....#.#",
			".#....#.....#............#..##.",
			"....#....##..........#.....##..",
			"#...........#....#...#..#...##.",
			"..#.......#.....#..........#...",
			".#..#................#......#..",
			"..#......#.#...#..#.#....#....#",
			"...#..#...###..#..##....#.#....",
			"..#..............#.....#.......",
			"...#.#...#.........#.#.........",
			"##......##...........##.#.##..#",
			"..#..##..#....#.#......#.#...##",
			"...#.###....###...#.....#......",
			"#.#................#......#....",
			"..#.....#.....#....##.......#..",
			".#.#...............##..#.......",
			"...#....#.......#.#.....##..#..",
			".........#....#.......#.#...##.",
			"#....#......##.#.........##...#",
			"#.............#..##.#.#..##....",
			"...#....#..#...#....#.#.#.#...#",
			".#....#....#..##.....#.#...###.",
			"##............#.#...##.#..#.#..",
			"##.#....##.....#..#..###....#..",
			"##....#................##......",
			"...##..#...#..###....#.....##..",
			".#...##......#..#.#.....#...#..",
			"..##......##...#.##.......#....",
			"......#.....#.....##........#.#",
			"##....#...........#............",
			"#.......#....#..#.##..##.#..#..",
			".#....##.#.....#..#..#.........",
			".#....#.#.#...#.....##.....#.#.",
			".......##.#.#........#......##.",
			"##........#.##.......#...#..#..",
			"...###..##....#.#....#.#.......",
			"......#.......#...##.....#...#.",
			"..#......##.#......#.....#.....",
			".....#.....###...#.............",
			"#...#.#...#...#..#......#......",
			"#.....#.......###.#....###.#...",
			"...#.......#....####....##..#..",
			"#.#.....#....#........#.......#",
			".........#.......#......#.#...#",
			"..##....#.....##...............",
			"..........#..#.#..#......#.....",
			"..................##...##.#....",
			"........#.......#...#..#.#.#...",
			".....#.#..##..#..#.#..#.......#",
			".....#........#..#..#....#....#",
			"##............#..#..#...#....#.",
			".....#....................##..#",
			"........##.#....###............",
			"##.......#.##................#.",
			".....###.#..#..#...#....###.##.",
			".#......#.#....#.....##.#......",
			"...##......##.........#...#....",
			"....####..............#........",
			"#...#.#..##..##.........##.....",
			"......#......#....#..#.........",
			"#.....#.....#.##...............",
			"..#.##..#...##.#.####..#....###",
			"#..#......#....#.##..##...#.#..",
			"#....#.......#.....#.....#.#...",
			"##.......#.....##...#.....#....",
			"...#...##..........#..##..##..#",
			".###..#..##...#....#...#..#....",
			"......##..###.......###...#....",
			"....#...#.#.......#.##...##..##",
			"#.#......#..##.#.#..#..#..#....",
			"......#........#.......#.......",
			"..........#.#.....##...........",
			"......#..#........#..#.#..###..",
			"##..#.............##..#........",
			".........#....#.....#.........#",
			".....#..##...#..#..##.##......#",
			"###..#...........#.......#....#",
			"...............#....#.#........",
			".##.#...#.#........##....#.....",
			".##.###...##..###....#...#...#.",
			".##..#....#.#.#...#.#.#.#...#..",
			".###.#...#.......#....#..#.....",
			"..#..#.#.#.#........#.....##...",
			".#.......#.#...#.#...........##",
			"...#.....##....#.....##...#....",
			"................#.....####...#.",
			".#.#......#.......##...#.##....",
			".###.........#.#......#..#.#...",
			"#......#...#....#..##.......#..",
			".##..#....#..#...........#...#.",
			".#...#.......##........#.##....",
			"..#...........#...##...........",
			".....##....##......#....#..#...",
			"#......#.#...#.##.#...##....#..",
			"#....................#...##...#",
			"..#............#........#......",
			".............#.........##.....#",
			"...#...#......##.#...#...#.#...",
			"..#...#.#.................#....",
			"....##...#....#...###.##......#",
			"...#....#...#..#...#....#.....#",
			"...##.#........#..#.........#..",
			"..##.....#..##...#.....##...#..",
			"#.........#.#.#...#......#...#.",
			"#.#...........#...#..#..#..##..",
			"..#..#..##....#..........#.###.",
			".....#..#....#.#...#...#..#..#.",
			"###.....#..#.................#.",
			".#..##.##.#......#....##..#...."
		};

		public static long Part1()
		{
			return CalculateNoOfTrees(_tobogganInput, 3, 1);
		}

		public static long Part2()
		{
			List<long> resultArray = new();
			resultArray.Add(CalculateNoOfTrees(_tobogganInput, 1, 1));
			resultArray.Add(CalculateNoOfTrees(_tobogganInput, 3, 1));
			resultArray.Add(CalculateNoOfTrees(_tobogganInput, 5, 1));
			resultArray.Add(CalculateNoOfTrees(_tobogganInput, 7, 1));
			resultArray.Add(CalculateNoOfTrees(_tobogganInput, 1, 2));

			return resultArray.Aggregate(1, (long treeProduct, long treeCount) => treeProduct * treeCount);
		}


		public const char TREE = '#';
		public const char SPACE = '.';

		public static int CalculateNoOfTrees(string[] map, int right, int down) {
			int currentColumn = 0;
			int mapWidth = map[0].Length;
			int noOfTreesHit = 0;

			for (int currentRow = 0; currentRow < map.Length; currentRow += down) {
				if (map[currentRow][currentColumn] == TREE) {
					noOfTreesHit++;
				}
				currentColumn = (currentColumn + right) % mapWidth;
			}

			return noOfTreesHit;
		}

	}

	/*
	 * https://adventofcode.com/2020/day/3
	 * 
	 * --- Day 3: Toboggan Trajectory ---
	 * 
	 * 
	 */
}